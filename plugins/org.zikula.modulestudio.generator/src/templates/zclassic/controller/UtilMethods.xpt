«IMPORT modulestudio»
«EXTENSION extensions::Utils»

«DEFINE CommonFunctionsBase FOR Application-»
/**
 * Utility helper base class
 */
class «appName()»_Base_Util
{
    /**
     * Returns an array of all allowed object types in «appName()».
     *
     * @return array list of allowed object types
     */
    public static function getObjectTypes()
    {
        $allowedObjectTypes = array();
«FOREACH models.entities AS entity-»
        $allowedObjectTypes[] = '«entity.name.formatForCode()»';
«ENDFOREACH-»
        return $allowedObjectTypes;
    }

    /**
     * Returns an array of all allowed object types in the generic block.
     *
     * @return array list of allowed object types
     */
    public static function getObjectTypesBlock()
    {
        return self::getObjectTypes();
    }

    /**
     * Returns an array of all allowed object types in the content type api.
     *
     * @return array list of allowed object types
     */
    public static function getObjectTypesContent()
    {
        return self::getObjectTypes();
    }

    /**
     * Utility method for managing view templates.
     */
    public static function processViewTemplate($view, $type, $objectType, $func, $args=array())
    {
        $template = DataUtil::formatForOS($type . '/' . $objectType . '_' . $func);
        $tpl = FormUtil::getPassedValue('tpl', isset($args['tpl']) ? $args['tpl'] : '');
        if (!empty($tpl) && $view->template_exists($template . '_' . DataUtil::formatForOS($tpl) . '.tpl')) {
            $template .= '_' . DataUtil::formatForOS($tpl);
        }
        $template .= '.tpl';

        $raw = FormUtil::getPassedValue('raw', (isset($args['raw']) && is_bool($args['raw'])) ? $args['raw'] : false);
        if ($raw == true) {
            // standalone output
            $view->display($template);
            return true;
        }

        // normal output
        return $view->fetch($template);
    }
}
«ENDDEFINE»

«DEFINE CommonFunctionsImpl FOR Application-»
/**
 * Utility helper implementation class
 */
class «appName()»_Util extends «appName()»_Base_Util
{
    // feel free to add your own convenience methods here
}
«ENDDEFINE»
